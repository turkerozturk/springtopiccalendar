<!--
This file is part of the DailyTopicTracker project.
Please refer to the project's README.md file for additional details.
https://github.com/turkerozturk/springtopiccalendar
-->

<div xmlns:th="http://www.thymeleaf.org" th:remove="tag">


<table class="table-bordered">

    <caption style="background-color:black;">
        <h4 th:text="${topic.name}" style="font-weight:bold;color:white;text-align:right;margin-right:130px;"></h4>
    </caption>

    <thead>
    <th></th>
    <th:block th:each="columnDate : ${topColumnDates}">
        <th th:text="${columnDate}"></th>
    </th:block>
    <th></th>
    </thead>

    <tbody>
    <tr th:each="dayMap, stat : ${weeklyMaps}">
        <td th:text="${dayNames[stat.index]}"> </td>


        <th:block th:each="entry : ${dayMap}">


            <th:block th:if="${entry.value != null }">
                <td th:title="${entry.key} + ' ' + ${entry.value.id}" th:class="'weekly-table-entry-cell status-' + ${entry.value.status}" >
                </td>
            </th:block>

            <!-- 2a) Eğer hiç entry yoksa 'New Entry' linki göster -->
            <th:block th:if="${entry.value == null }">
                <td class="weekly-table-entry-cell"  th:title="${entry.key}">
                    &nbsp;
                </td>
            </th:block>





        </th:block>

        <td th:text="${dayNames[stat.index]}"> </td>







    </tr>
    </tbody>

    <tfoot>
    <th></th>
    <th:block th:each="columnDate : ${bottomColumnDates}">
        <th th:text="${columnDate}"></th>
    </th:block>
    <th></th>
    </tfoot>


</table>

    <table id="statisticsContainer" class="table">
        <tr>
            <td class="col-7">

            </td>


            <td class="col-3">

                <!-- some statistics -->
                <table class="table table-sm table-bordered">
                    <thead>
                    <tr>
                        <th>Weekday</th>
                        <th>Note</th>
                        <th>Done</th>
                        <th>Warn</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="i : ${#numbers.sequence(0, 6)}">
                        <td th:text="${dayNames[i]}"></td>
                        <td th:text="${status0[i]}"></td>
                        <td th:text="${status1[i]}"></td>
                        <td th:text="${status2[i]}"></td>
                    </tr>
                    <tr>
                        <td><b>Total</b></td>
                        <td th:text="${totalStatus0}" class="status-0" style="font-weight:bold;"></td>
                        <td th:text="${totalStatus1}" class="status-1" style="font-weight:bold;"></td>
                        <td th:text="${totalStatus2}" class="status-2" style="font-weight:bold;"></td>


                    </tr>
                    </tbody>
                </table>

            </td>

            <td class="col-2">

                <!-- chart -->

                <canvas id="status1Chart" ></canvas>
            </td>
        </tr>

    </table>


    <script th:inline="javascript">
        /*<![CDATA[*/
        var status1Counts = [[${status1}]];
        var labels = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

        new Chart(document.getElementById('status1Chart'), {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Status 1 Entries',
                    data: status1Counts,
                    backgroundColor: [
                        '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                        '#9966FF', '#FF9F40', '#66BB6A'
                    ]
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Distribution of entries marked as "Done" by day of the week'
                    }
                }
            }
        });
        /*]]>*/
    </script>


</div>

